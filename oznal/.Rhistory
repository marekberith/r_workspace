separate_longer_delim(player_positions, delim = ', ') %>%
group_by(nationality_name, preferred_foot, player_positions)
task6
# task 6 - Retrieve positions at which Slovak left footed players play.
task6 <- df %>% select(nationality_name, preferred_foot, player_positions) %>%
filter(nationality_name == 'Slovakia' & preferred_foot == 'Left') %>%
separate_longer_delim(player_positions, delim = ', ') %>%
group_by(nationality_name, preferred_foot, player_positions) %>%
summarise(toString(unique(player_positions)))
task6
# task 6 - Retrieve positions at which Slovak left footed players play.
task6 <- df %>% select(nationality_name, preferred_foot, player_positions) %>%
filter(nationality_name == 'Slovakia' & preferred_foot == 'Left') %>%
separate_longer_delim(player_positions, delim = ', ') %>%
group_by(nationality_name, preferred_foot) %>%
summarise(toString(unique(player_positions)))
task6
# task 7 - Present your result as in a tabular form with counts for each
# position. Only one playing position per column is allowed.
# Convert empty cells/NAs to 0s.
task7 <- df %>% select(nationality_name, preferred_foot, player_positions) %>%
filter(nationality_name == 'Slovakia' & preferred_foot == 'Left') %>%
separate_longer_delim(player_positions, delim = ', ') %>%
group_by(nationality_name, preferred_foot, player_positions) %>%
summaruse(sum(player_positions))
# task 7 - Present your result as in a tabular form with counts for each
# position. Only one playing position per column is allowed.
# Convert empty cells/NAs to 0s.
task7 <- df %>% select(nationality_name, preferred_foot, player_positions) %>%
filter(nationality_name == 'Slovakia' & preferred_foot == 'Left') %>%
separate_longer_delim(player_positions, delim = ', ') %>%
group_by(nationality_name, preferred_foot, player_positions) %>%
summarise(sum(player_positions))
task7
# task 7 - Present your result as in a tabular form with counts for each
# position. Only one playing position per column is allowed.
# Convert empty cells/NAs to 0s.
task7 <- df %>% select(nationality_name, preferred_foot, player_positions) %>%
filter(nationality_name == 'Slovakia' & preferred_foot == 'Left') %>%
separate_longer_delim(player_positions, delim = ', ') %>%
group_by(nationality_name, preferred_foot, player_positions) %>%
summarise(count(player_positions))
# task 7 - Present your result as in a tabular form with counts for each
# position. Only one playing position per column is allowed.
# Convert empty cells/NAs to 0s.
task7 <- df %>% select(nationality_name, preferred_foot, player_positions) %>%
filter(nationality_name == 'Slovakia' & preferred_foot == 'Left') %>%
separate_longer_delim(player_positions, delim = ', ') %>%
group_by(nationality_name, preferred_foot, player_positions) %>%
summarise(n())
task7
# task 7 - Present your result as in a tabular form with counts for each
# position. Only one playing position per column is allowed.
# Convert empty cells/NAs to 0s.
task7 <- df %>% select(nationality_name, preferred_foot, player_positions) %>%
filter(nationality_name == 'Slovakia' & preferred_foot == 'Left') %>%
separate_longer_delim(player_positions, delim = ', ') %>%
group_by(nationality_name, preferred_foot, player_positions) %>%
summarise(count_on_position = n())
task7
# task 8 - Left footers are thought to be more creative offensive players.
# But how do they fare as defensive players? Let’s find the difference
# in their defensive rating (column defending) and split the resulting
# data according to player’s height. Compare righties and lefties.
task8 <- df %>% select(preferred_foot, defending, height_cm) %>%
group_by(height_cm,preferred_foot) %>%
summarise(average = mean(defending))
task8
# task 8 - Left footers are thought to be more creative offensive players.
# But how do they fare as defensive players? Let’s find the difference
# in their defensive rating (column defending) and split the resulting
# data according to player’s height. Compare righties and lefties.
task8 <- df %>% select(preferred_foot, defending, height_cm) %>%
group_by(height_cm,preferred_foot) %>%
summarise(average = mean(defending), number_of_players = n())
task8
View(task8)
# task 9: Find Slovak and Czech left footed players whose data show the
# biggest difference between their overall and potential scores.
# These guys will be the prime targets for any scout.
# Be gentleman and sort the resulting table in a descending order.
task9 <- df %>% select(nationality_name, preferred_foot, overall, potential) %>%
filter(nationality_name %in% c('Slovakia', 'Czech Republic'))
task9
# task 9: Find Slovak and Czech left footed players whose data show the
# biggest difference between their overall and potential scores.
# These guys will be the prime targets for any scout.
# Be gentleman and sort the resulting table in a descending order.
task9 <- df %>% select(nationality_name, preferred_foot, overall, potential) %>%
filter(nationality_name %in% c('Slovakia', 'Czech Republic') & preferred_foot == 'Left') %>%
task9
# task 9: Find Slovak and Czech left footed players whose data show the
# biggest difference between their overall and potential scores.
# These guys will be the prime targets for any scout.
# Be gentleman and sort the resulting table in a descending order.
task9 <- df %>% select(nationality_name, preferred_foot, overall, potential) %>%
filter(nationality_name %in% c('Slovakia', 'Czech Republic') & preferred_foot == 'Left') %>%
task9
# task 9: Find Slovak and Czech left footed players whose data show the
# biggest difference between their overall and potential scores.
# These guys will be the prime targets for any scout.
# Be gentleman and sort the resulting table in a descending order.
task9 <- df %>% select(nationality_name, preferred_foot, overall, potential) %>%
filter(nationality_name %in% c('Slovakia', 'Czech Republic') & preferred_foot == 'Left')
task9
# task 9: Find Slovak and Czech left footed players whose data show the
# biggest difference between their overall and potential scores.
# These guys will be the prime targets for any scout.
# Be gentleman and sort the resulting table in a descending order.
task9 <- df %>% select(nationality_name, preferred_foot, potential - overall) %>%
filter(nationality_name %in% c('Slovakia', 'Czech Republic') & preferred_foot == 'Left')
# task 9: Find Slovak and Czech left footed players whose data show the
# biggest difference between their overall and potential scores.
# These guys will be the prime targets for any scout.
# Be gentleman and sort the resulting table in a descending order.
task9 <- df %>% select(nationality_name, preferred_foot, overall, potential) %>%
filter(nationality_name %in% c('Slovakia', 'Czech Republic') & preferred_foot == 'Left') %>%
task9
# task 9: Find Slovak and Czech left footed players whose data show the
# biggest difference between their overall and potential scores.
# These guys will be the prime targets for any scout.
# Be gentleman and sort the resulting table in a descending order.
task9 <- df %>% select(nationality_name, preferred_foot, overall, potential) %>%
filter(nationality_name %in% c('Slovakia', 'Czech Republic') & preferred_foot == 'Left') %>%
add_column(diff = potential - overall)
task9
# task 9: Find Slovak and Czech left footed players whose data show the
# biggest difference between their overall and potential scores.
# These guys will be the prime targets for any scout.
# Be gentleman and sort the resulting table in a descending order.
task9 <- df %>% select(nationality_name, preferred_foot, overall, potential) %>%
filter(nationality_name %in% c('Slovakia', 'Czech Republic') & preferred_foot == 'Left') %>%
add_column(diff = potential - overall)
# task 9: Find Slovak and Czech left footed players whose data show the
# biggest difference between their overall and potential scores.
# These guys will be the prime targets for any scout.
# Be gentleman and sort the resulting table in a descending order.
task9 <- df %>% select(nationality_name, preferred_foot, overall, potential) %>%
filter(nationality_name %in% c('Slovakia', 'Czech Republic') & preferred_foot == 'Left') %>%
mutate(diff = potential - overall)
task9
# task 9: Find Slovak and Czech left footed players whose data show the
# biggest difference between their overall and potential scores.
# These guys will be the prime targets for any scout.
# Be gentleman and sort the resulting table in a descending order.
task9 <- df %>% select(nationality_name, preferred_foot, overall, potential) %>%
filter(nationality_name %in% c('Slovakia', 'Czech Republic') & preferred_foot == 'Left') %>%
mutate(diff = potential - overall) %>%
order(diff, decreasing = T)
task9 <- df %>% select(nationality_name, preferred_foot, overall, potential) %>%
filter(nationality_name %in% c('Slovakia', 'Czech Republic') & preferred_foot == 'Left') %>%
mutate(diff = potential - overall)
# task 9: Find Slovak and Czech left footed players whose data show the
# biggest difference between their overall and potential scores.
# These guys will be the prime targets for any scout.
# Be gentleman and sort the resulting table in a descending order.
task9 <- df %>% select(nationality_name, preferred_foot, overall, potential) %>%
filter(nationality_name %in% c('Slovakia', 'Czech Republic') & preferred_foot == 'Left') %>%
mutate(diff = potential - overall) %>%
order(diff, decreasing = T)
task9
# task 9: Find Slovak and Czech left footed players whose data show the
# biggest difference between their overall and potential scores.
# These guys will be the prime targets for any scout.
# Be gentleman and sort the resulting table in a descending order.
task9 <- df %>% select(nationality_name, preferred_foot, overall, potential) %>%
filter(nationality_name %in% c('Slovakia', 'Czech Republic') & preferred_foot == 'Left') %>%
mutate(diff = potential - overall) %>%
arrange(diff, decreasing = T)
task9
# task 9: Find Slovak and Czech left footed players whose data show the
# biggest difference between their overall and potential scores.
# These guys will be the prime targets for any scout.
# Be gentleman and sort the resulting table in a descending order.
task9 <- df %>% select(nationality_name, preferred_foot, overall, potential) %>%
filter(nationality_name %in% c('Slovakia', 'Czech Republic') & preferred_foot == 'Left') %>%
mutate(diff = potential - overall) %>%
arrange(diff, decreasing = F)
task9
# task 9: Find Slovak and Czech left footed players whose data show the
# biggest difference between their overall and potential scores.
# These guys will be the prime targets for any scout.
# Be gentleman and sort the resulting table in a descending order.
task9 <- df %>% select(nationality_name, preferred_foot, overall, potential) %>%
filter(nationality_name %in% c('Slovakia', 'Czech Republic') & preferred_foot == 'Left') %>%
mutate(diff = potential - overall) %>%
arrange(desc(diff))
task9
# task 9: Find Slovak and Czech left footed players whose data show the
# biggest difference between their overall and potential scores.
# These guys will be the prime targets for any scout.
# Be gentleman and sort the resulting table in a descending order.
task9 <- df %>% select(, nationality_name, preferred_foot, overall, potential) %>%
filter(nationality_name %in% c('Slovakia', 'Czech Republic') & preferred_foot == 'Left') %>%
mutate(diff = potential - overall) %>%
arrange(desc(diff))
task9
# task 9: Find Slovak and Czech left footed players whose data show the
# biggest difference between their overall and potential scores.
# These guys will be the prime targets for any scout.
# Be gentleman and sort the resulting table in a descending order.
task9 <- df %>% select(, nationality_name, preferred_foot, overall, potential) %>%
filter(nationality_name %in% c('Slovakia', 'Czech Republic') & preferred_foot == 'Left') %>%
mutate(diff = potential - overall) %>%
arrange(desc(diff))
# task 9: Find Slovak and Czech left footed players whose data show the
# biggest difference between their overall and potential scores.
# These guys will be the prime targets for any scout.
# Be gentleman and sort the resulting table in a descending order.
task9 <- df %>% select(short_name, nationality_name, preferred_foot, overall, potential) %>%
filter(nationality_name %in% c('Slovakia', 'Czech Republic') & preferred_foot == 'Left') %>%
mutate(diff = potential - overall) %>%
arrange(desc(diff))
task9
# task 10: Which Slovak and Czech left footed players have the highest
# BMI and at which position do they play?
task10 <- df %>% select(short_name, nationality_name, preferred_foot) %>%
filter(nationality_name %in% c('Slovakia', 'Czech Republic') & preferred_foot == 'Left') %>%
mutate(bmi = overall)
# task 10: Which Slovak and Czech left footed players have the highest
# BMI and at which position do they play?
task10 <- df %>% select(short_name, nationality_name, preferred_foot, weight_kg, height_cm) %>%
filter(nationality_name %in% c('Slovakia', 'Czech Republic') & preferred_foot == 'Left') %>%
mutate(bmi = weight_kg / (height_cm/100)**2)
task10
# task 10: Which Slovak and Czech left footed players have the highest
# BMI and at which position do they play?
task10 <- df %>% select(short_name, nationality_name, preferred_foot, weight_kg, height_cm, player_positions) %>%
filter(nationality_name %in% c('Slovakia', 'Czech Republic') & preferred_foot == 'Left') %>%
mutate(bmi = weight_kg / (height_cm/100)**2) %>%
arrange(desc(bmi))
task10
library('tidyverse')
df <- read_csv('C:/R/r_workspace/data/players_22.csv')
# task 4
df %>% select(nationality_name, preferred_foot) %>%
filter(nationality_name %in% c("Slovakia", "Czech Republic")) %>%
group_by(nationality_name, preferred_foot) %>%
summarize(count = n()) %>%
pivot_wider(names_from = preferred_foot, values_from = count) %>%
mutate(Total = Left + Right, Proportion = Left / (Left + Right))
# task 4
df %>% select(nationality_name, preferred_foot) %>%
filter(nationality_name %in% c('Slovakia', 'Czech Republic')) %>%
group_by(nationality_name, preferred_foot) %>%
summarize(count = n()) %>%
pivot_wider(names_from = preferred_foot, values_from = count) %>%
mutate(Total = Left + Right, Proportion = Left / (Left + Right))
df %>% select(nationality_name, preferred_foot) %>%
filter(nationality_name %in% c('Slovakia', 'Czech Republic')) %>%
group_by(nationality_name, preferred_foot) %>%
summarize(count = n())
# task 4
df %>% select(nationality_name, preferred_foot) %>%
filter(nationality_name %in% c('Slovakia', 'Czech Republic')) %>%
group_by(nationality_name, preferred_foot) %>%
summarize(count = n()) %>%
pivot_wider(names_from = preferred_foot, values_from = count) %>%
mutate(Total = Left + Right, Proportion = Left / (Left + Right))
library(tidyverse)
library(tidymodels)
library(magrittr)
options(scipen=999)
tidymodels_prefer() # resolve package conflicts using tidy models methods
data(ames)
hist(x = ames$Sale_Price, freq = F, breaks = 50)
ames <- ames %>% mutate(Sale_Price = log10(Sale_Price))
# stratified sampling, which is more complex than random sampling
set.seed(502)
ames_split <- initial_split(ames, prop = 0.8, strata = Sale_Price)
ames_train <- training(ames_split)
ames_test <- testing(ames_split)
# tasks
# task 1
df <- read_csv('data/Practicum.5.1.csv')
# tasks
# task 1
df <- read_csv('data/Practicum.5.1.csv')
library(tidyverse)
library(tidymodels)
library(magrittr)
options(scipen=999)
tidymodels_prefer() # resolve package conflicts using tidy models methods
data(ames)
hist(x = ames$Sale_Price, freq = F, breaks = 50)
ames <- ames %>% mutate(Sale_Price = log10(Sale_Price))
# stratified sampling, which is more complex than random sampling
set.seed(502)
ames_split <- initial_split(ames, prop = 0.8, strata = Sale_Price)
ames_train <- training(ames_split)
ames_test <- testing(ames_split)
# tasks
# task 1
df <- read_csv('data/Practicum.5.1.csv')
hist(df$Sale_Price, breaks = 100)
# task 2
df_grouped <- df %>%
group_by(ID, Sale_Price) %>%
summarise(SF_total = sum(Value_SF))
df_grouped
# task 3
pairs(df_grouped)
# task 4
library(rsample)
folds <- vfold_cv(df_grouped, v = 5)
# task 3
pairs(df_grouped)
# task 2
df_grouped <- df %>%
group_by(ID, Sale_Price) %>%
summarise(SF_total = sum(Value_SF))
df
# tasks
# task 1
df <- read_csv('data/Practicum.5.1.csv')
# tasks
# task 1
df <- read_csv('data//Practicum.5.1.csv')
# tasks
# task 1
df <- read_csv('data/Practicum.5.1.csv')
# tasks
# task 1
df <- read_csv('../data/Practicum.5.1.csv')
# task 2
df_grouped <- df %>%
group_by(ID, Sale_Price) %>%
summarise(SF_total = sum(Value_SF))
df_grouped
# task 3
pairs(df_grouped)
# task 4
library(rsample)
folds <- vfold_cv(df_grouped, v = 5)
print(folds)
training_data <- training(folds)
# task 4
install.packages('rsample')
install.packages("rsample")
install.packages('rtools')
install.packages('Rtools')
library(rsample)
folds <- vfold_cv(df_grouped, v = 5)
print(folds)
training_data <- training(folds)
update.packages(oldPkgs="rsample", ask=FALSE)
library(tidyverse)
library(tidymodels)
library(magrittr)
options(scipen=999)
tidymodels_prefer() # resolve package conflicts using tidy models methods
data(ames)
hist(x = ames$Sale_Price, freq = F, breaks = 50)
ames <- ames %>% mutate(Sale_Price = log10(Sale_Price))
# stratified sampling, which is more complex than random sampling
set.seed(502)
ames_split <- initial_split(ames, prop = 0.8, strata = Sale_Price)
ames_train <- training(ames_split)
ames_test <- testing(ames_split)
# tasks
# task 1
df <- read_csv('../data/Practicum.5.1.csv')
hist(df$Sale_Price, breaks = 100)
# task 2
df_grouped <- df %>%
group_by(ID, Sale_Price) %>%
summarise(SF_total = sum(Value_SF))
df_grouped
# task 3
pairs(df_grouped)
library(rsample)
folds <- vfold_cv(df_grouped, v = 5)
print(folds)
training_data <- training(folds)
library(tidyverse)
library(tidymodels)
library(magrittr)
tidymodels_prefer() # resolve package conflicts using tidy models methods
data(ames)
hist(x = ames$Sale_Price, freq = F, breaks = 50)
ames <- ames %>% mutate(Sale_Price = log10(Sale_Price))
# tasks
# task 1
df <- read_csv('../data/Practicum.5.1.csv')
hist(df$Sale_Price, breaks = 100)
# task 2
df_grouped <- df %>%
group_by(ID, Sale_Price) %>%
summarise(SF_total = sum(Value_SF))
df_grouped
# task 3
pairs(df_grouped)
library(rsample)
folds <- vfold_cv(df_grouped, v = 5)
print(folds)
training_data <- training(folds)
print(folds)
fold1 <- analysis(folds, 1)
folds <- vfold_cv(df_grouped, v = 5)
training_data <- training(folds)
print(folds)
fold1 <- as.data.frame(folds$splits[[1]])
fold1
print(folds)
fold1
print(folds)
print(folds$splits)
print(folds)
print(folds[1])
print(folds[,1])
print(folds[1,])
print(training(folds[1,]))
print(training(folds[1,]$splits))
print(folds[1,]$splits)
print(analysis(folds[1,]$splits))
fold_i <- as.data.frame(folds$splits[[1]])
fold_i
train <- training(fold_i)
train <- analysis(fold_i)
fold_i <- as.data.frame(folds$splits[[1]])
train <- analysis(fold_i)
ames_split
ames_split <- initial_split(ames, prop = 0.8, strata = Sale_Price)
ames_split
fold_i
fold_i <- folds$splits[[1]]
fold_i
train <- analysis(fold_i)
train
fold_i
test <- assessment(fold_i)
model <- lm(Sale_price~SF_total, data = train)
model <- lm(Sale_Price~SF_total, data = train)
plot(model)
library(tidyverse)
library(tidymodels)
library(magrittr)
options(scipen=999)
tidymodels_prefer() # resolve package conflicts using tidy models methods
data(ames)
hist(x = ames$Sale_Price, freq = F, breaks = 50)
ames <- ames %>% mutate(Sale_Price = log10(Sale_Price))
# tasks
# task 1
df <- read_csv('../data/Practicum.5.1.csv')
hist(df$Sale_Price, breaks = 100)
# task 2
df_grouped <- df %>%
group_by(ID, Sale_Price) %>%
summarise(SF_total = sum(Value_SF))
df_grouped
# task 3
pairs(df_grouped)
# task 4
library(rsample)
folds <- vfold_cv(df_grouped, v = 5)
fold_i <- folds$splits[[1]]
fold_i
train <- analysis(fold_i)
test <- assessment(fold_i)
model <- lm(Sale_Price~SF_total, data = train)
plot(model)
plot(model)
plot(model)
plot(model)
plot(model)
plot(model)
k
k <- plot(model)
k
k <- plot(model)
plot_model(model)
train
train[train$ID in {1, 2, 3}]
train[c(1746, 1745, 1196),]
qqnorm(train)
qqnorm(train$Sale_Price)
qqnorm(train[c(1746, 1745, 1196),]$Sale_Price)
train
qqnorm(train$Sale_Price)
qqplot(train$Sale_Price)
qqPlot(train$Sale_Price)
norm
qqnorm(train$Sale_Price)
train[train$ID = 1746,]
train[train$ID == 1746,]
#task 6
model <- lm(Sale_Price~SF_total, data = folds)
plot(model)
# task 7
coef(model)
#test
coef(lm(Sale_Price~SF_total, data = test))
#' We are predicting Sale_Price. Intercept means constant that is always
#' there and SF_total coeficient means that for every increase of 1 in SF_total,
#' the Sale_Price is increased by value of this coeficient, which in our case
#' is about 51
#test
model_test <- lm(Sale_Price~SF_total, data = test)
coef(model_test)
# task 6
model_train <- lm(Sale_Price~SF_total, data = train)
plot(model_train)
# task 7
#train
coef(model_train)
#test
model_test <- lm(Sale_Price~SF_total, data = test)
coef(model_test)
# task 9
summary(model_train)
summary(model_test)
